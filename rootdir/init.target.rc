on boot

    # doubletap to wake
    chown system radio /sys/devices/soc/11008000.i2c/i2c-1/1-0020/input/input6/wake_gesture
    chown system radio /sys/devices/soc/11008000.i2c/i2c-1/1-0020/input/input7/wake_gesture
    chmod 664 /sys/devices/soc/11008000.i2c/i2c-1/1-0020/input/input6/wake_gesture
    chmod 664 /sys/devices/soc/11008000.i2c/i2c-1/1-0020/input/input7/wake_gesture

    symlink /sys/devices/soc/11008000.i2c/i2c-1/1-0020/input/input6/wake_gesture /dev/wake_gesture

    # Enable KSM
    write /sys/kernel/mm/ksm/pages_to_scan 100
    write /sys/kernel/mm/ksm/sleep_millisecs 500
    write /sys/kernel/mm/ksm/run 1

    # Tune I/O
    write /sys/block/mmcblk0/queue/add_random 0
    write /sys/block/mmcblk0/queue/iosched/slice_idle 0
    write /sys/block/mmcblk0/bdi/read_ahead_kb 128

on post-fs
    swapon_all /fstab.porridge
    write /proc/sys/vm/page-cluster 0

# If the mag is present, the TPD is shifted
on property:init.svc.af7133d=running
    rm /dev/wake_gesture
    symlink /sys/devices/soc/11008000.i2c/i2c-1/1-0020/input/input7/wake_gesture /dev/wake_gesture
